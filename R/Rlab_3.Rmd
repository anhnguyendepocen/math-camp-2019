---
title: 'R Lab 3: Matrix Algebra with R'
author: "Ikuma Ogura"
institution: "Georgetown University"
date: "August 22, 2019"
fontsize: 10pt
output: 
  beamer_presentation:
    theme: Boadilla
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Today

- Vector and matrix algebra with R

\smallskip

- Accessing to vector/matrix elements with R

\smallskip

- (Time permitting) `apply()` function

## Creating Vectors and Matrices

- As covered yesterday, in R we create vectors using `c()` command.

\smallskip

- We can create matrices with `matrix()` command
\begin{block}{Usage}
\texttt{matrix(data, nrow, ncol, byrow)} \\
\end{block}
where
    - `data`: vector of matrix elements
    - `nrow`, `ncol`: number of rows/columns
    - `byrow`: if `TRUE`, the matrix is filled by rows; if `FALSE`, it is filled with columns
    
## Creating Vectors and Matrices: Example

```{r, tidy = FALSE}
# Creating matrices
A <- matrix(data = c(1, 4, 3, 5), nrow = 2, byrow = TRUE)
B <- matrix(data = c(1, 4, 3, 5), nrow = 2, byrow = FALSE)
C <- matrix(data = c(9, 7, 6, 2, 1, 3), nrow = 2, 
            byrow = TRUE)
D <- matrix(data = c(2, 4, 5, 7, 1, 2), nrow = 3, 
            byrow = TRUE)
# Print
A
B
```

## Creating Vectors and Matrices: Example (cont.)

```{r, tidy = FALSE}
C
D
```

## Vector Operations

```{r, tidy = FALSE}
# Creating vectors
a <- c(1, 4, 5, 3, 7)
b <- c(3, 2, 4, 7, 1)
c <- c(8, -2, -4)
# Vector operations
a + b # vector addition
3 * a # scalar product
a + 3 # !?
```


## Vector operations (cont.)

```{r, tidy = FALSE}
a %*% b # dot/inner product
a * b # different from above!
```

## Matrix operations

```{r, tidy = FALSE}
A - B # matrix addition/subtraction
3 * C # scalar product
A + 2
```

## Matrix operations (cont.)

```{r, tidy = FALSE}
A %*% B # matrix product
A * B # different from above!
```

## Matrix operations (cont.)

```{r, tidy = FALSE}
t(C) %*% B # t() to transpose matrices
C %*% c # vectors are treated as the k by 1 matrices
t(c) %*% D
```

## Determinant & Inverse

```{r, tidy = FALSE}
det(A)
solve(B)
```

## Solving System of Equations

- We can also use `solve()` command

\smallskip

- Example: Let's solve the following system of equations with R.

$$
\begin{aligned}
x + 3y &= 7 \\
2x + 5y &= 10
\end{aligned}
$$
```{r, tidy = FALSE}
coefs <- matrix(c(1, 3, 2, 5), nrow = 2, byrow = TRUE)
rhs <- c(7, 10)
solve(coefs, rhs)
```

## Vector/Matrix Operations: Summary

Command | Meaning
--- | ---
`+` | Summation
`-` | Subtraction
`*` | Element-wise product (Adamar product)
`%*%` | Matrix/Vector product
`length()` | (For vectors) Vector length
`dim()` | (For matrices) Matrix dimension
`t()` | Transpose
`det()` | Determinant
`solve()` | Inverse
`diag(A)` | ($\boldsymbol{A}$ is a square matrix) Extract diagonal elements
`diag(k)` | ($k$ is a scalar) Create a $k \times k$ identity matrix
`eigen()` | Compute eigenvalues and eigenvectors

## Accessing to Vector/Matrix Elements

- For vectors: `vectorname[i]` extracts the $i$th element of the vector

    - We can put in a vector within `[]` to extract multiple elements
    - If we specify negative numbers within `[]`, R deletes corresponding elements

\smallskip

- For matrices: `matrixname[i, j]` extracts the element in $i$th row and $j$th column

    - `matrixname[i,]` extracts all the elements in $i$th row as a vector
    - `matrixname[, j]` extracts all the elements in $j$th column as a vector

## Accessing to Vector/Matrix Elements: Example

```{r, tidy = FALSE}
b[3]
a[c(2, 4)]
b[c(-1, -5)]
C[2, 1]
D[-2,]
```

## Accessing to Vector/Matrix Elements: Example (cont.)

```{r, tidy = FALSE}
B[1, 1] <- 9
B
C[, 2] <- c(8, 3) 
C
```

## Excersices!

For the following matrix
$$
\boldsymbol{A} = \begin{pmatrix} 7 & -3 & 0 \\
-2 & 6 & 1 \\
0 & -5 & 6 
\end{pmatrix},
$$

1. find the determinant

2. calculate the inverse

3. replace the third row to $(-4, 2, -1)$ and recompute the determinant

4. delete the first row and third column and find its inverse matrix

## apply()

- We use `apply()` function when we apply a command/function to each row/column
\begin{block}{Usage}
\texttt{apply(X, MARGIN, FUN...)} \\
\end{block}
where 
    - `X`: a matrix we apply a function
    - `MARGIN`: set 1 when we want to apply a function to each row; set 2 when we apply the function to each column
    - `FUN`: function to apply 

## apply(): Example

```{r, tidy = FALSE}
apply(A, 1, sum)
apply(C, 2, prod)
```

## Tomorrow

- Introduction to

    - loading data into R
    - data preprocessing with R
    - summarizing data with R


